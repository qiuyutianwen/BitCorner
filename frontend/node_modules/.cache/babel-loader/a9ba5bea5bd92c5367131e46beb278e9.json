{"ast":null,"code":"var _jsxFileName = \"/Users/qiuyutianwen/Documents/GitHub/BitCorner/frontend/src/pages/Bills.js\",\n    _s = $RefreshSig$();\n\nimport Reactm, { useState, useEffect } from 'react';\nimport { Jumbotron, Button, Row, Col, Form, Table, Card, InputGroup, FormControl, ListGroup, Modal } from 'react-bootstrap';\nimport { faTimes, faSearch, faUserFriends } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Application } from '../components/export';\nimport Bill from '../components/Bill';\nimport { updateToBill, payABill } from '../actions/billAction';\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport 'react-datepicker/dist/react-datepicker-cssmodules.min.css';\nimport * as api from '../api/index';\nimport * as constant from '../constants/constant'; //{USD_RMB, USD_EUR, USD_GBP, USD_INR, USD_BTC}\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Bills = () => {\n  _s();\n\n  const allUser = useSelector(state => state.auth ? state.auth.allUser : null);\n  const user = useSelector(state => state.auth ? state.auth.user : null);\n  const allBills = useSelector(state => state.bill ? state.bill.allBill : null);\n  const userBalance = useSelector(state => state.auth.balance ? state.auth.balance : null);\n  const [editDisplay, setEditDisplay] = useState(\"none\");\n  const [payDisplay, setPayDisplay] = useState(\"none\");\n  const [users, setUsers] = useState(\"none\");\n  const [search, setSearch] = useState(\"\");\n  const [searchOutput, setSearchOutput] = useState([]);\n  const [show, setShow] = useState(false);\n  const [name, setName] = useState();\n  const [currentCurrency, setCurrentCurrency] = useState(\"\");\n  const [view, setView] = useState(false);\n  const [bills, setBills] = useState(allBills ? allBills.filter(b => b.status !== \"Cancelled\") : null);\n  const [payBill, setPayBill] = useState({\n    currency: \"USD\"\n  });\n  const [fee, setFee] = useState();\n  const [editBill, setEditBill] = useState({\n    status: \"\",\n    amount: \"\",\n    description: \"\",\n    due_date: \"\",\n    check: false\n  });\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true);\n\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (allUser) setUsers(allUser);\n\n    if (allBills) {\n      setBills(allBills.filter(b => b.status !== \"Cancelled\"));\n      console.log(\"bills inside Bills.js\", bills);\n    }\n  }, [allUser, allBills]);\n\n  const onSubmit = () => {\n    console.log(\"submit bill!\", editBill);\n  };\n\n  const toggleEditDisplay = async (input, check) => {\n    if (editDisplay === \"none\") {\n      const {\n        data\n      } = await api.getOneBill(input);\n      setEditBill(data); // setCurrentCurrency(data.currency)\n      // editBill['check'] = check\n\n      setView(check);\n      setEditDisplay(\"display\");\n    } else {\n      setEditDisplay(\"none\");\n    }\n  };\n\n  const togglePayDisplay = async () => {\n    if (payDisplay === \"none\") {\n      setPayDisplay(\"display\");\n    } else {\n      setPayDisplay(\"none\");\n    }\n  };\n\n  const searchUser = name => {\n    console.log(\"search for\", name);\n    setSearch(name);\n    const afterUser = users.filter(a => a.username.includes(name) || a.nickname.includes(name));\n    let selectedUser = users.filter(a => a.username.includes(name));\n    selectedUser = selectedUser.filter(a => a.nickname !== user.nickname);\n    console.log(\"afterUser\", selectedUser);\n    setSearchOutput(selectedUser);\n  };\n\n  const statusList = ['Cancelled', 'Waiting'];\n  let statusOption = statusList.map((item, index) => {\n    return /*#__PURE__*/_jsxDEV(\"option\", {\n      value: item,\n      children: item\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 16\n    }, this);\n  });\n  const currencies = ['EUR', \"USD\", 'GBP', 'INR', 'CNY', 'BITCOIN'];\n  let currencyOption = currencies.map((item, index) => {\n    return /*#__PURE__*/_jsxDEV(\"option\", {\n      value: item,\n      children: item\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 4\n    }, this);\n  });\n\n  const handleChange = event => {\n    const target = event.target;\n    const value = target.value;\n    const targetname = target.name;\n\n    if (targetname === \"status\") {\n      // console.log(\"inside\");\n      // editBill[\"amount\"] = \"\"\n      // setOtherCurrency(true)\n      setEditBill({ ...editBill,\n        [targetname]: value\n      }); // setEditDisplay(\"none\")\n    } else {\n      setPayBill({ ...payBill,\n        currency: value\n      });\n      console.log(\"hehehe\", currentCurrency + `_USD`, payBill.amount, `USD_` + payBill.currency); // setPayDisplay(\"none\")\n    }\n  };\n\n  const detail = input => {\n    console.log(\"getting detail of user\", input);\n    let currentUser = allUser.filter(a => a.nickname === input);\n    setName(currentUser && currentUser.length > 0 ? currentUser[0] : null);\n    setShow(true);\n    setSearch(\"\");\n  };\n\n  const reject = async id => {\n    console.log(\"reject\", id); // setEditBill({...editBill, id, status: \"Rejected\"})\n\n    const {\n      data\n    } = await api.getOneBill(id);\n    setPayBill(data);\n    payBill['status'] = \"Rejected\";\n    console.log(\"editBill\", payBill);\n    await dispatch(updateToBill(payBill));\n    alert(\"You rejected a bill #\", id);\n  };\n\n  const pay = async id => {\n    togglePayDisplay();\n    const {\n      data\n    } = await api.getOneBill(id);\n    setPayBill(data);\n    setCurrentCurrency(data.currency);\n  };\n\n  const edit = async () => {\n    delete editBill['check'];\n    console.log(\"edit\", editBill);\n    await dispatch(updateToBill(editBill));\n  };\n\n  const submitPay = async () => {\n    console.log(\"currentCurrency:\", currentCurrency);\n    console.log(\"payBill.currency:\", payBill.currency);\n\n    if (currentCurrency !== payBill.currency) {\n      if (currentCurrency !== \"USD\" && payBill.currency !== \"USD\") {\n        console.log(\"CASE: A\");\n        payBill['paidAmount'] = constant[currentCurrency + `_USD`] * payBill.amount * constant[`USD_` + payBill.currency];\n        payBill['transaction_fee'] = constant[currentCurrency + `_USD`] * payBill.amount * constant[`USD_` + payBill.currency] * 0.0001;\n      } else if (currentCurrency !== \"USD\" && payBill.currency === \"USD\") {\n        console.log(\"CASE: B\");\n        payBill['paidAmount'] = constant[currentCurrency + `_USD`] * payBill.amount;\n        payBill['transaction_fee'] = constant[currentCurrency + `_USD`] * payBill.amount * 0.0001;\n      } else if (currentCurrency === \"USD\" && payBill.currency !== \"USD\") {\n        console.log(\"CASE: C\");\n        payBill['paidAmount'] = constant[`USD_` + payBill.currency] * payBill.amount;\n        payBill['transaction_fee'] = constant[`USD_` + payBill.currency] * payBill.amount * 0.0001;\n      } else {\n        console.log(\"ERROR\");\n      }\n    } else {\n      console.log(\"CASE: D\");\n      payBill['paidAmount'] = payBill.amount;\n      payBill['transaction_fee'] = 0;\n    }\n\n    if (payBill.currency === \"BITCOIN\") {\n      payBill['paidType'] = \"btc\";\n    } else payBill['paidType'] = payBill.currency.toLowerCase();\n\n    console.log(\"payBill\", payBill);\n    let isAbleToPay = false;\n\n    switch (payBill.paidType) {\n      case 'usd':\n        {\n          if (userBalance.usd > payBill.paidAmount) isAbleToPay = true;\n          break;\n        }\n\n      case 'eur':\n        {\n          if (userBalance.eur > payBill.paidAmount) isAbleToPay = true;\n          break;\n        }\n\n      case 'cny':\n        {\n          if (userBalance.cny > payBill.paidAmount) isAbleToPay = true;\n          break;\n        }\n\n      case 'gbp':\n        {\n          if (userBalance.gbp > payBill.paidAmount) isAbleToPay = true;\n          break;\n        }\n\n      case 'inr':\n        {\n          if (userBalance.inr > payBill.paidAmount) isAbleToPay = true;\n          break;\n        }\n\n      case 'btc':\n        {\n          if (userBalance.btc > payBill.paidAmount) isAbleToPay = true;\n          break;\n        }\n\n      default:\n        break;\n    }\n\n    if (isAbleToPay) {\n      await dispatch(payABill(payBill.id, payBill.paidType, payBill.paidAmount, payBill.transaction_fee)); //billId, paidType, paidAmount, transaction_fee\n    } else {\n      window.alert(\"You don't have enough fund to pay bill\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"60%\",\n        margin: \"0 auto\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: \"100px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Form.Group, {\n          controlId: \"formBasicDescription\",\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            children: /*#__PURE__*/_jsxDEV(Col, {\n              children: [/*#__PURE__*/_jsxDEV(InputGroup, {\n                className: \"col-mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(InputGroup.Prepend, {\n                  children: /*#__PURE__*/_jsxDEV(InputGroup.Text, {\n                    children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                      icon: faSearch\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 249,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 248,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n                  placeholder: \"Send a bill to other user\",\n                  \"aria-label\": \"Search\",\n                  \"aria-describedby\": \"basic-addon2\",\n                  value: search,\n                  onChange: e => searchUser(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n                style: {\n                  zIndex: 10\n                },\n                children: [console.log(\"before search selectedUser\", search, searchOutput), search && searchOutput ? searchOutput.map((item, index) => {\n                  if (item.nickname) {\n                    return /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                      className: \"search-result\",\n                      action: true,\n                      onClick: () => detail(item.nickname),\n                      children: item.nickname ? item.nickname : item.username\n                    }, index, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 266,\n                      columnNumber: 29\n                    }, this);\n                  }\n                }) : null]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        className: \"justify-content-center\",\n        children: /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Bills\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: bills && bills.length !== 0 ? /*#__PURE__*/_jsxDEV(Table, {\n          striped: true,\n          bordered: true,\n          hover: true,\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"#\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Amount\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Edit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Operation\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: bills.map((item, index) => {\n              return /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: item.id\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 302,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: item.status\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: item.amount\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 304,\n                  columnNumber: 37\n                }, this), item.receiver_id !== user.id && item.status !== \"Cancelled\" && item.status !== \"Paid\" && item.status !== \"Rejected\" ? /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"link\",\n                    onClick: () => toggleEditDisplay(item.id, true),\n                    style: {\n                      padding: \"0px\"\n                    },\n                    children: \"Edit\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 307,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 37\n                }, this) : /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"link\",\n                    onClick: () => toggleEditDisplay(item.id, false),\n                    style: {\n                      padding: \"0px\"\n                    },\n                    children: \"View\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 310,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 309,\n                  columnNumber: 37\n                }, this), item.sender_id !== user.id && item.status !== \"Paid\" && item.status !== \"Rejected\" && item.status !== \"Cancelled\" && item.status !== \"Overdue\" ? /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"link\",\n                    onClick: () => reject(item.id),\n                    style: {\n                      padding: \"0px\"\n                    },\n                    children: \"Reject\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 315,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    className: \"ml-3\",\n                    variant: \"link\",\n                    onClick: () => pay(item.id),\n                    style: {\n                      padding: \"0px\"\n                    },\n                    children: \"Pay\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 316,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 314,\n                  columnNumber: 37\n                }, this) : /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: \"None Action\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 318,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 36\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 17\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"There is no bill available now!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        show: show,\n        onHide: handleClose,\n        children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n          closeButton: true,\n          children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n            children: \"Send Bills\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n          children: /*#__PURE__*/_jsxDEV(Bill, {\n            value: name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Application.Base, {\n        display: editDisplay,\n        children: [/*#__PURE__*/_jsxDEV(Application.Close, {\n          toggleDisplay: toggleEditDisplay,\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faTimes\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 70\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 17\n        }, this), view ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            children: \"Edit Bill\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"status\",\n              children: \"Bill Status\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              name: \"status\",\n              id: \"status\",\n              value: editBill.status,\n              className: \"form-control\",\n              onChange: handleChange,\n              children: statusOption\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicDate\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Bill Amount: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              value: editBill.amount,\n              onChange: e => setEditBill({ ...editBill,\n                amount: e.target.value\n              }),\n              type: \"text\",\n              placeholder: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicDate\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Bill Description: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              value: editBill.description,\n              onChange: e => setEditBill({ ...editBill,\n                description: e.target.value\n              }),\n              type: \"text\",\n              placeholder: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicDate\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Due Date: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 56\n            }, this), /*#__PURE__*/_jsxDEV(DatePicker, {\n              selected: editBill.due_date,\n              onChange: date => setEditBill({ ...editBill,\n                due_date: date\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"primary\",\n            onClick: edit,\n            children: \"Edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            children: \"View Bill\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicAmount\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Bill Status: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Form.Label, {\n              children: editBill.status\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicAmount\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Bill Currency: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 377,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Form.Label, {\n              children: editBill.currency\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicAmount\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Bill Amount: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 381,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Form.Label, {\n              children: editBill.amount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicDescription\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Bill Description: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 68\n            }, this), /*#__PURE__*/_jsxDEV(Form.Label, {\n              children: editBill.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicDue\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Due Date: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 60\n            }, this), /*#__PURE__*/_jsxDEV(Form.Label, {\n              children: Date(editBill.due_date).substring(0, 24)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Application.Base, {\n        display: payDisplay,\n        children: [/*#__PURE__*/_jsxDEV(Application.Close, {\n          toggleDisplay: togglePayDisplay,\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faTimes\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 69\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n          children: \"Pay a bill\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n            controlId: \"formBasicAmount\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Bill Currency: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 400,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Form.Label, {\n              children: currentCurrency ? currentCurrency : null\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 90\n            }, this), /*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Bill Amount: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 402,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Form.Label, {\n              children: payBill && payBill.amount ? payBill.amount : null\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"payCurrency\",\n            children: \"Pay Currency\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            name: \"payCurrency\",\n            id: \"payCurrency\",\n            value: payBill && payBill.currency ? payBill.currency : null,\n            className: \"form-control\",\n            onChange: handleChange,\n            children: currencyOption\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 17\n        }, this), payBill && (currentCurrency !== payBill.currency ? /*#__PURE__*/_jsxDEV(Form.Label, {\n          children: [\"Fee: \", currentCurrency !== 'USD' ? constant[currentCurrency + `_USD`] * payBill.amount * constant[`USD_` + payBill.currency] * 0.0001 : constant[`USD_` + payBill.currency] * payBill.amount * 0.0001, \" (0.01%)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 73\n        }, this) : null), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 296\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: submitPay,\n          children: \"Pay\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n\n_s(Bills, \"Ad+lM2oOYvk0ojJqw8c4jKMK0PA=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector, useDispatch];\n});\n\n_c = Bills;\nexport default Bills;\n\nvar _c;\n\n$RefreshReg$(_c, \"Bills\");","map":{"version":3,"sources":["/Users/qiuyutianwen/Documents/GitHub/BitCorner/frontend/src/pages/Bills.js"],"names":["Reactm","useState","useEffect","Jumbotron","Button","Row","Col","Form","Table","Card","InputGroup","FormControl","ListGroup","Modal","faTimes","faSearch","faUserFriends","FontAwesomeIcon","useDispatch","useSelector","Application","Bill","updateToBill","payABill","DatePicker","api","constant","Bills","allUser","state","auth","user","allBills","bill","allBill","userBalance","balance","editDisplay","setEditDisplay","payDisplay","setPayDisplay","users","setUsers","search","setSearch","searchOutput","setSearchOutput","show","setShow","name","setName","currentCurrency","setCurrentCurrency","view","setView","bills","setBills","filter","b","status","payBill","setPayBill","currency","fee","setFee","editBill","setEditBill","amount","description","due_date","check","handleClose","handleShow","dispatch","console","log","onSubmit","toggleEditDisplay","input","data","getOneBill","togglePayDisplay","searchUser","afterUser","a","username","includes","nickname","selectedUser","statusList","statusOption","map","item","index","currencies","currencyOption","handleChange","event","target","value","targetname","detail","currentUser","length","reject","id","alert","pay","edit","submitPay","toLowerCase","isAbleToPay","paidType","usd","paidAmount","eur","cny","gbp","inr","btc","transaction_fee","window","width","margin","height","e","zIndex","receiver_id","padding","sender_id","date","Date","substring"],"mappings":"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","sourcesContent":["import Reactm, {useState, useEffect} from 'react'\nimport { Jumbotron, Button, Row, Col, Form, Table, Card, InputGroup, FormControl, ListGroup, Modal } from 'react-bootstrap';\nimport { faTimes, faSearch, faUserFriends} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Application } from '../components/export';\nimport Bill from '../components/Bill';\nimport { updateToBill, payABill } from '../actions/billAction';\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\"\nimport 'react-datepicker/dist/react-datepicker-cssmodules.min.css'\nimport * as api from '../api/index';\nimport * as constant from '../constants/constant'\n//{USD_RMB, USD_EUR, USD_GBP, USD_INR, USD_BTC}\nconst Bills = () => {\n    const allUser = useSelector((state) => state.auth ? state.auth.allUser : null)\n    const user = useSelector((state) => state.auth ? state.auth.user : null)\n    const allBills = useSelector((state) => state.bill ? state.bill.allBill : null)\n    const userBalance = useSelector((state) => state.auth.balance ? state.auth.balance : null)\n\n    const [editDisplay, setEditDisplay] = useState(\"none\");\n    const [payDisplay, setPayDisplay] = useState(\"none\");\n    const [users, setUsers] = useState(\"none\");\n    const [search, setSearch] = useState(\"\");\n    const [searchOutput, setSearchOutput] = useState([]);\n    const [show, setShow] = useState(false);\n    const [name, setName] = useState();\n    const [currentCurrency, setCurrentCurrency] = useState(\"\");\n    const [view, setView] = useState(false);\n    const [bills, setBills] = useState(allBills ? allBills.filter(b => b.status !== \"Cancelled\") : null)\n    const [payBill, setPayBill] = useState({currency: \"USD\"});\n    const [fee, setFee] = useState();\n\n    const [editBill, setEditBill] = useState({\n        status: \"\",\n        amount: \"\",\n        description: \"\",\n        due_date: \"\",\n        check: false\n    });\n\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n\n    const dispatch = useDispatch()\n\n\n    useEffect(() => {\n        if(allUser)\n            setUsers(allUser)\n        if(allBills){\n            setBills(allBills.filter(b => b.status !== \"Cancelled\"))\n            console.log(\"bills inside Bills.js\", bills);\n        }\n    }, [allUser, allBills])\n\n    const onSubmit = () => {\n        console.log(\"submit bill!\", editBill);\n    }\n\n    \n    const toggleEditDisplay = async (input, check) => {\n        if(editDisplay === \"none\"){\n            const {data} = await api.getOneBill(input)\n            setEditBill(data)\n            // setCurrentCurrency(data.currency)\n            // editBill['check'] = check\n            setView(check)\n            setEditDisplay(\"display\")\n        }else{\n            setEditDisplay(\"none\")\n        }\n    }\n\n    const togglePayDisplay = async () => {\n        if(payDisplay === \"none\"){\n            \n            setPayDisplay(\"display\")\n        }else{\n            setPayDisplay(\"none\")\n        }\n    }\n\n    const searchUser = (name) => {\n        console.log(\"search for\", name);\n        setSearch(name)\n        const afterUser = users.filter((a) => a.username.includes(name) || a.nickname.includes(name))\n        let selectedUser = users.filter((a) => a.username.includes(name))\n        selectedUser = selectedUser.filter((a) => a.nickname !== user.nickname)\n\n        console.log(\"afterUser\", selectedUser);\n        setSearchOutput(selectedUser)\n    }\n\n    const statusList = ['Cancelled', 'Waiting']\n    let statusOption = statusList.map((item, index) => {\n        return <option value={item} key={index}>{item}</option>\n    });\n\n    const currencies = ['EUR',  \"USD\", 'GBP', 'INR', 'CNY', 'BITCOIN'];\n\tlet currencyOption = currencies.map((item, index) => {\n\t\treturn (\n\t\t\t<option value={item} key={index}>\n\t\t\t\t{item}\n\t\t\t</option>\n\t\t);\n\t});\n\n    const handleChange = event => {\n        const target = event.target;\n        const value = target.value;\n        const targetname = target.name\n        if(targetname === \"status\"){\n            // console.log(\"inside\");\n            // editBill[\"amount\"] = \"\"\n            // setOtherCurrency(true)\n            setEditBill({...editBill, [targetname]: value})\n            // setEditDisplay(\"none\")\n        }else{\n            setPayBill({...payBill, currency: value})\n            console.log(\"hehehe\", currentCurrency+`_USD`, payBill.amount, `USD_`+payBill.currency);\n            // setPayDisplay(\"none\")\n        }\n        \n    }\n\n    const detail = (input) => {\n        console.log(\"getting detail of user\", input);\n        let currentUser = allUser.filter((a) => a.nickname === input )\n        setName(currentUser && currentUser.length > 0 ? currentUser[0] : null)\n        setShow(true)\n        setSearch(\"\")\n    }\n\n    const reject = async (id) => {\n        console.log(\"reject\", id);\n        // setEditBill({...editBill, id, status: \"Rejected\"})\n        const {data} = await api.getOneBill(id)\n        setPayBill(data)\n        payBill['status'] = \"Rejected\"\n        console.log(\"editBill\", payBill);\n        await dispatch(updateToBill(payBill))\n        alert(\"You rejected a bill #\", id)\n    }\n\n    const pay = async (id) => {\n        togglePayDisplay()\n        const {data} = await api.getOneBill(id)\n        setPayBill(data)\n        setCurrentCurrency(data.currency)\n    }\n\n    const edit = async () => {\n        delete editBill['check']\n        console.log(\"edit\", editBill);\n        await dispatch(updateToBill(editBill))\n    }\n\n    const submitPay = async () => {\n        console.log(\"currentCurrency:\", currentCurrency);\n        console.log(\"payBill.currency:\", payBill.currency);\n        if(currentCurrency !== payBill.currency){\n            if(currentCurrency !== \"USD\" && payBill.currency !== \"USD\"){\n                console.log(\"CASE: A\")\n                payBill['paidAmount'] = (constant[currentCurrency + `_USD`])*(payBill.amount)*(constant[`USD_` + payBill.currency]);\n                payBill['transaction_fee'] = constant[currentCurrency + `_USD`]*payBill.amount*constant[`USD_` + payBill.currency]*0.0001;\n            }\n            else if(currentCurrency !== \"USD\" && payBill.currency === \"USD\"){\n                console.log(\"CASE: B\");\n                payBill['paidAmount'] = ((constant[currentCurrency + `_USD`])*(payBill.amount));\n                payBill['transaction_fee'] = ((constant[currentCurrency + `_USD`])*(payBill.amount))*0.0001;\n            }\n            else if(currentCurrency === \"USD\" && payBill.currency !== \"USD\"){\n                console.log(\"CASE: C\");\n                payBill['paidAmount'] = ((constant[`USD_` + payBill.currency])*(payBill.amount));\n                payBill['transaction_fee'] = ((constant[`USD_` + payBill.currency])*(payBill.amount))*0.0001;\n            }\n            else{\n                console.log(\"ERROR\");\n            }\n        }else{\n            console.log(\"CASE: D\");\n            payBill['paidAmount'] = payBill.amount;\n            payBill['transaction_fee'] = 0\n        }\n       \n        if(payBill.currency === \"BITCOIN\"){\n            payBill['paidType'] = \"btc\";\n        }\n        else\n            payBill['paidType'] = payBill.currency.toLowerCase();\n        \n        console.log(\"payBill\", payBill);\n\n        let isAbleToPay = false;\n        switch(payBill.paidType){\n            case 'usd': {\n                if(userBalance.usd > payBill.paidAmount)\n                    isAbleToPay = true;\n                break;\n            }\n            case 'eur': {\n                if(userBalance.eur > payBill.paidAmount)\n                    isAbleToPay = true;\n                break;\n            }\n            case 'cny': {\n                if(userBalance.cny > payBill.paidAmount)\n                    isAbleToPay = true;\n                break;\n            }\n            case 'gbp': {\n                if(userBalance.gbp > payBill.paidAmount)\n                    isAbleToPay = true;\n                break;\n            }\n            case 'inr': {\n                if(userBalance.inr > payBill.paidAmount)\n                    isAbleToPay = true;\n                break;\n            }\n            case 'btc': {\n                if(userBalance.btc > payBill.paidAmount)\n                    isAbleToPay = true;\n                break;\n            }\n            default:\n                break;\n        }\n        \n        if(isAbleToPay){\n            await dispatch(payABill(payBill.id, payBill.paidType, payBill.paidAmount, payBill.transaction_fee));//billId, paidType, paidAmount, transaction_fee\n        }\n        else{\n            window.alert(\"You don't have enough fund to pay bill\");\n        }\n    }\n\n    return (\n        <>\n        <div style={{width: \"60%\", margin: \"0 auto\"}}>\n            <div style={{height: \"100px\"}}>\n                <Form.Group controlId=\"formBasicDescription\">\n                <Row>\n                <Col>\n                <InputGroup className=\"col-mb-3\">\n                    <InputGroup.Prepend>\n                    <InputGroup.Text>\n                        <FontAwesomeIcon icon={faSearch} />\n                    </InputGroup.Text>\n                    </InputGroup.Prepend>\n                    <FormControl\n                    placeholder=\"Send a bill to other user\"\n                    aria-label=\"Search\"\n                    aria-describedby=\"basic-addon2\"\n                    value={search}\n                    onChange={(e) => searchUser(e.target.value)}\n                    />\n                </InputGroup>\n                <ListGroup style={{zIndex: 10}}>\n                    {console.log(\"before search selectedUser\", search, searchOutput)}\n                    {search && searchOutput\n                    ? searchOutput.map((item, index) => {\n                        if (item.nickname) {\n                            return (\n                            <ListGroup.Item\n                                className=\"search-result\"\n                                action\n                                onClick={() => detail(item.nickname)}\n                                key={index}\n                            >\n                                {item.nickname ? item.nickname : item.username}\n                            </ListGroup.Item>\n                            );\n                        }\n                        })\n                    : null}\n                </ListGroup>\n                </Col>\n            </Row>\n            </Form.Group>\n            </div>\n            <Row className=\"justify-content-center\">\n                <h4>Bills</h4>\n            </Row>\n            <Row>\n                {/* {console.log(\"bills\",bills)} */}\n                {bills && bills.length !== 0 ? \n                <Table striped bordered hover>\n                    <thead>\n                        <tr>\n                        <th>#</th>\n                        <th>Status</th>\n                        <th>Amount</th>\n                        <th>Edit</th>\n                        <th>Operation</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {bills.map((item, index) => {\n                            return <tr>\n                                    <td>{item.id}</td>\n                                    <td>{item.status}</td>\n                                    <td>{item.amount}</td>\n                                    {item.receiver_id !== user.id && item.status !== \"Cancelled\" && item.status !== \"Paid\" && item.status !== \"Rejected\" ? \n                                    <td>\n                                        <Button variant=\"link\" onClick={() => toggleEditDisplay(item.id, true)} style={{padding: \"0px\"}}>Edit</Button>\n                                    </td> : \n                                    <td> \n                                        <Button variant=\"link\" onClick={() => toggleEditDisplay(item.id, false)} style={{padding: \"0px\"}}>View</Button>\n                                    </td>\n                                    }\n                                    {item.sender_id !== user.id && item.status !== \"Paid\" && item.status !== \"Rejected\" && item.status !==\"Cancelled\" && item.status !== \"Overdue\" ? \n                                    <td>\n                                        <Button variant=\"link\" onClick={() => reject(item.id)} style={{padding: \"0px\"}}>Reject</Button>\n                                        <Button className=\"ml-3\" variant=\"link\" onClick={() => pay(item.id)} style={{padding: \"0px\"}}>Pay</Button>\n                                    </td> : \n                                    <td> \n                                        None Action\n                                    </td>\n                                    }\n                                </tr>\n                        })}\n                    </tbody>\n                </Table>\n                :\n                <div>There is no bill available now!</div>}\n                \n            </Row>\n            <Modal show={show} onHide={handleClose}>\n                <Modal.Header closeButton>\n                    <Modal.Title>Send Bills</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <Bill value={name} />\n                </Modal.Body>\n        </Modal>    \n        <Application.Base display = {editDisplay}>\n                <Application.Close toggleDisplay={toggleEditDisplay}><FontAwesomeIcon icon={faTimes} /></Application.Close>\n                {/* {console.log(\"editBill\",editBill)} */}\n                {view ?\n                <>\n                <h6>Edit Bill</h6>\n                <div className=\"form-group\">\n                <label htmlFor=\"status\">Bill Status</label>\n                    <select\n                        name=\"status\"\n                        id=\"status\"\n                        value={editBill.status}\n                        className=\"form-control\"\n                        onChange={handleChange}>\n                        {statusOption}\n                    </select>\n                </div>\n                <Form.Group controlId=\"formBasicDate\">\n                    <Form.Label>Bill Amount: </Form.Label>\n                    <Form.Control value={editBill.amount} onChange={(e) => setEditBill({ ...editBill, amount: e.target.value })}type=\"text\" placeholder=\"\" />\n                </Form.Group>\n                <Form.Group controlId=\"formBasicDate\" >\n                    <Form.Label>Bill Description: </Form.Label>\n                    <Form.Control value={editBill.description} onChange={(e) => setEditBill({ ...editBill, description: e.target.value })}type=\"text\" placeholder=\"\" />\n                </Form.Group>\n                <Form.Group controlId=\"formBasicDate\" >\n                    <Form.Label>Due Date: </Form.Label><br/>\n                    <DatePicker selected={editBill.due_date} onChange={date => setEditBill({...editBill, due_date:date})} />\n                </Form.Group>\n                <Button variant=\"primary\" onClick={edit}>Edit</Button> \n                </>\n                : \n                <div>\n                    <h6>View Bill</h6>\n                    <Form.Group controlId=\"formBasicAmount\">\n                        <Form.Label>Bill Status: </Form.Label>\n                        <Form.Label>{editBill.status}</Form.Label>\n                    </Form.Group>\n                    <Form.Group controlId=\"formBasicAmount\">\n                        <Form.Label>Bill Currency: </Form.Label>\n                        <Form.Label>{editBill.currency}</Form.Label>\n                    </Form.Group>\n                    <Form.Group controlId=\"formBasicAmount\">\n                        <Form.Label>Bill Amount: </Form.Label>\n                        <Form.Label>{editBill.amount}</Form.Label>\n                    </Form.Group>\n                    <Form.Group controlId=\"formBasicDescription\" >\n                        <Form.Label>Bill Description: </Form.Label><br/>\n                        <Form.Label>{editBill.description}</Form.Label>\n                    </Form.Group>\n                    <Form.Group controlId=\"formBasicDue\" >\n                        <Form.Label>Due Date: </Form.Label><br/>\n                        <Form.Label>{Date(editBill.due_date).substring(0,24)}</Form.Label>\n                    </Form.Group>\n                </div>\n                }\n            </Application.Base>\n            <Application.Base display = {payDisplay}>\n                <Application.Close toggleDisplay={togglePayDisplay}><FontAwesomeIcon icon={faTimes} /></Application.Close>\n                <h6>Pay a bill</h6>\n                <div className=\"form-group\">\n                    <Form.Group controlId=\"formBasicAmount\">\n                        <Form.Label>Bill Currency: </Form.Label>\n                        <Form.Label>{currentCurrency ? currentCurrency:null}</Form.Label><br/>\n                        <Form.Label>Bill Amount: </Form.Label>\n                        <Form.Label>{payBill && payBill.amount ? payBill.amount:null}</Form.Label>\n                    </Form.Group>\n                    <label htmlFor=\"payCurrency\">Pay Currency</label>\n                        <select\n                            name=\"payCurrency\"\n                            id=\"payCurrency\"\n                            value={payBill && payBill.currency ? payBill.currency:null}\n                            className=\"form-control\"\n                            onChange={handleChange}>\n                            {currencyOption}\n                        </select>\n                    </div>\n                    {payBill && (currentCurrency !== payBill.currency ? <Form.Label>Fee: {currentCurrency !== 'USD' ? constant[currentCurrency+`_USD`]*payBill.amount*constant[`USD_`+payBill.currency]*0.0001 : constant[`USD_`+payBill.currency]*payBill.amount*0.0001} (0.01%)</Form.Label> : null)}<br />\n                    <Button variant=\"primary\" onClick={submitPay}>Pay</Button>\n            </Application.Base>\n        </div>\n        </>\n    )\n}\n\nexport default Bills\n"]},"metadata":{},"sourceType":"module"}