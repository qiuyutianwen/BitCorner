{"ast":null,"code":"import firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { loginUser } from '../actions/authActions';\nvar config = {\n  apiKey: 'AIzaSyBBeCIYkeLaJ0lUA2KGpNpMlvXwLvNrBo8',\n  authDomain: 'fir-demo-fd377.firebaseapp.com',\n  databaseURL: 'https://fir-demo-fd377.firebaseio.com',\n  projectId: 'fir-demo-fd377',\n  storageBucket: 'fir-demo-fd377.appspot.com',\n  messagingSenderId: '230297250895',\n  appId: '1:230297250895:web:c3cab715836619c6a68e3a',\n  measurementId: 'G-G3J8XRHPZS'\n};\nfirebase.initializeApp(config);\nexport const auth = firebase.auth();\nconst provider = new firebase.auth.GoogleAuthProvider();\nprovider.setCustomParameters({\n  prompt: 'select_account'\n});\nexport const signInWithGoogle = (dispatch, history) => {\n  console.log('google signin');\n  auth.signInWithPopup(provider).then(async result => {\n    console.log(result.credential.accessToken);\n    const user = result.user;\n    localStorage.setItem('email', user.email);\n    localStorage.setItem('google_id', user.uid);\n    let nickname = user.email.split('@')[0];\n    nickname = nickname.replace(/[^a-z0-9+]+/gi, '');\n    await dispatch(loginUser({\n      username: user.email,\n      // google: true,\n      nickname: nickname,\n      googleId: user.uid\n    }));\n    history.push('/');\n  }).catch(err => {\n    console.log(err);\n  });\n};\nexport default firebase;","map":{"version":3,"sources":["/Users/qiuyutianwen/Documents/GitHub/BitCorner/frontend/src/utils/firebase.utils.js"],"names":["firebase","loginUser","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","initializeApp","auth","provider","GoogleAuthProvider","setCustomParameters","prompt","signInWithGoogle","dispatch","history","console","log","signInWithPopup","then","result","credential","accessToken","user","localStorage","setItem","email","uid","nickname","split","replace","username","googleId","push","catch","err"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,cAArB;AACA,OAAO,eAAP;AACA,SAASC,SAAT,QAA0B,wBAA1B;AACA,IAAIC,MAAM,GAAG;AACZC,EAAAA,MAAM,EAAE,yCADI;AAEZC,EAAAA,UAAU,EAAE,gCAFA;AAGZC,EAAAA,WAAW,EAAE,uCAHD;AAIZC,EAAAA,SAAS,EAAE,gBAJC;AAKZC,EAAAA,aAAa,EAAE,4BALH;AAMZC,EAAAA,iBAAiB,EAAE,cANP;AAOZC,EAAAA,KAAK,EAAE,2CAPK;AAQZC,EAAAA,aAAa,EAAE;AARH,CAAb;AAWAV,QAAQ,CAACW,aAAT,CAAuBT,MAAvB;AAEA,OAAO,MAAMU,IAAI,GAAGZ,QAAQ,CAACY,IAAT,EAAb;AAEP,MAAMC,QAAQ,GAAG,IAAIb,QAAQ,CAACY,IAAT,CAAcE,kBAAlB,EAAjB;AACAD,QAAQ,CAACE,mBAAT,CAA6B;AAAEC,EAAAA,MAAM,EAAE;AAAV,CAA7B;AACA,OAAO,MAAMC,gBAAgB,GAAG,CAACC,QAAD,EAAWC,OAAX,KAAuB;AACtDC,EAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACAT,EAAAA,IAAI,CAACU,eAAL,CAAqBT,QAArB,EACEU,IADF,CACO,MAAOC,MAAP,IAAkB;AACvBJ,IAAAA,OAAO,CAACC,GAAR,CAAYG,MAAM,CAACC,UAAP,CAAkBC,WAA9B;AACA,UAAMC,IAAI,GAAGH,MAAM,CAACG,IAApB;AACAC,IAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BF,IAAI,CAACG,KAAnC;AACAF,IAAAA,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkCF,IAAI,CAACI,GAAvC;AACA,QAAIC,QAAQ,GAAGL,IAAI,CAACG,KAAL,CAAWG,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAf;AACAD,IAAAA,QAAQ,GAAGA,QAAQ,CAACE,OAAT,CAAiB,eAAjB,EAAkC,EAAlC,CAAX;AACA,UAAMhB,QAAQ,CACbjB,SAAS,CAAC;AACTkC,MAAAA,QAAQ,EAAER,IAAI,CAACG,KADN;AAET;AACAE,MAAAA,QAAQ,EAAEA,QAHD;AAITI,MAAAA,QAAQ,EAAET,IAAI,CAACI;AAJN,KAAD,CADI,CAAd;AAQAZ,IAAAA,OAAO,CAACkB,IAAR,CAAa,GAAb;AACA,GAjBF,EAkBEC,KAlBF,CAkBSC,GAAD,IAAS;AACfnB,IAAAA,OAAO,CAACC,GAAR,CAAYkB,GAAZ;AACA,GApBF;AAqBA,CAvBM;AAyBP,eAAevC,QAAf","sourcesContent":["import firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { loginUser } from '../actions/authActions';\nvar config = {\n\tapiKey: 'AIzaSyBBeCIYkeLaJ0lUA2KGpNpMlvXwLvNrBo8',\n\tauthDomain: 'fir-demo-fd377.firebaseapp.com',\n\tdatabaseURL: 'https://fir-demo-fd377.firebaseio.com',\n\tprojectId: 'fir-demo-fd377',\n\tstorageBucket: 'fir-demo-fd377.appspot.com',\n\tmessagingSenderId: '230297250895',\n\tappId: '1:230297250895:web:c3cab715836619c6a68e3a',\n\tmeasurementId: 'G-G3J8XRHPZS',\n};\n\nfirebase.initializeApp(config);\n\nexport const auth = firebase.auth();\n\nconst provider = new firebase.auth.GoogleAuthProvider();\nprovider.setCustomParameters({ prompt: 'select_account' });\nexport const signInWithGoogle = (dispatch, history) => {\n\tconsole.log('google signin');\n\tauth.signInWithPopup(provider)\n\t\t.then(async (result) => {\n\t\t\tconsole.log(result.credential.accessToken);\n\t\t\tconst user = result.user;\n\t\t\tlocalStorage.setItem('email', user.email);\n\t\t\tlocalStorage.setItem('google_id', user.uid);\n\t\t\tlet nickname = user.email.split('@')[0];\n\t\t\tnickname = nickname.replace(/[^a-z0-9+]+/gi, '');\n\t\t\tawait dispatch(\n\t\t\t\tloginUser({\n\t\t\t\t\tusername: user.email,\n\t\t\t\t\t// google: true,\n\t\t\t\t\tnickname: nickname,\n\t\t\t\t\tgoogleId: user.uid,\n\t\t\t\t})\n\t\t\t);\n\t\t\thistory.push('/');\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t});\n};\n\nexport default firebase;\n"]},"metadata":{},"sourceType":"module"}